(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{387:function(t,e,r){"use strict";r.r(e);r(73);var o=r(16),n=(r(74),r(24)),c=r(72),d=(r(37),{asyncData:function(){return c.b.collection("productos").orderBy("nombre").get().then(function(t){var e=[];return t.forEach(function(t){e.push(Object(n.a)({id:t.id},t.data()))}),{productos:e,currentPage:1,perPage:10}})},data:function(){return{show:!1,isBusy:!1,boxTwo:"",define:"",idEditar:"",tituloModal:"Editar producto",form:{nombre:"",cantidad:"",precio:""},imageProduct:"",variable:!1,nameState:null,categoria:["MATERIAL ESCOLAR","MATERIAL DE OFICINA"],fields:[{key:"imagen"},{key:"nombre"},{key:"categoria"},{key:"precio"},{key:"cantidad"},{key:"acciones"}]}},computed:{rows:function(){return this.productos.length}},methods:{eliminarProductos:function(t,e){var r=this;1==confirm("DESEA REALMENTE ELIMINAR ESTE PRODUCTO?")&&c.b.collection("productos").doc(t).delete().then(function(){r.productos.map(function(e,r){e.id==t&&r}),r.productos.splice(e,1)})},editarProducto:function(t,e){var r=this;this.variable=!1,this.tituloModal="Editar producto",this.define="editar",this.idEditar=t,this.productos.map(function(e,o){e.id==t&&(r.form={nombre:e.nombre,cantidad:e.cantidad,precio:e.precio,imagen:e.imagen})})},checkFormValidity:function(){var t=this.$refs.form.checkValidity();return this.nameState=t?"valid":"invalid",t},resetModal:function(){this.nameState=null},handleOk:function(t){t.preventDefault(),this.handleSubmit()},handleSubmit:function(){var t=this;if(this.checkFormValidity()){if(this.isBusy=!0,"editar"==this.define)c.c.child(this.imageProduct.name).put(this.imageProduct).then(function(){var e=Object(o.a)(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.ref.getDownloadURL();case 2:t.form.imagen=e.sent,c.b.collection("productos").doc(t.idEditar).set(t.form).then(function(e){c.b.collection("productos").orderBy("nombre").get().then(function(e){t.productos=[],e.forEach(function(e){t.productos.push(Object(n.a)({id:e.id},e.data()))}),t.isBusy=!1})});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());this.$nextTick(function(){t.$refs.modal.hide()})}}}}),l=r(19),component=Object(l.a)(d,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"row mt-5"},[t._m(0),t._v(" "),r("div",{staticClass:"col-sm-1"},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.nuevo",modifiers:{nuevo:!0}}],attrs:{variant:"primary",href:"/productos/crear"}},[t._v("Nuevo")])],1)]),t._v(" "),r("div",{staticClass:"row mt-2"},[r("b-table",{attrs:{striped:"",hover:"",id:"my-table",fields:t.fields,items:t.productos,"per-page":t.perPage,"current-page":t.currentPage,small:""},scopedSlots:t._u([{key:"acciones",fn:function(data){return[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.editar",modifiers:{editar:!0}}],staticClass:"open-AddBookDialog",attrs:{type:"button",variant:"success"},on:{click:function(e){return t.editarProducto(data.item.id,data.index)}}},[t._v("Editar")]),t._v(" "),r("b-button",{attrs:{variant:"danger",type:"button"},on:{click:function(e){return t.eliminarProductos(data.item.id,data.index)}}},[t._v("eliminar")])]}},{key:"imagen",fn:function(data){return[r("b-img",{attrs:{src:data.item.imagen,width:"100",height:"100"}})]}}])},[r("div",{staticClass:"text-center my-2",attrs:{slot:"table-busy"},slot:"table-busy"},[r("b-spinner",{staticClass:"align-middle"}),t._v(" "),r("strong",[t._v("Cargando...")])],1)])],1),t._v(" "),r("b-modal",{ref:"modal",attrs:{"header-bg-variant":"dark","header-text-variant":"light",id:"editar",title:t.tituloModal},on:{show:t.resetModal,hidden:t.resetModal,ok:t.handleOk},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[r("b-form-group",{attrs:{id:"input-group-1",label:"Imagen:","label-for":"imagen"}},[r("b-form-file",{attrs:{placeholder:"Elige una imagen",accept:"image/"},model:{value:t.imageProduct,callback:function(e){t.imageProduct=e},expression:"imageProduct"}})],1),t._v(" "),r("b-form-group",{attrs:{state:t.nameState,label:"Nombre","label-for":"nombre","invalid-feedback":"Ingresa un nombre"}},[r("b-form-input",{attrs:{id:"nombre",state:t.nameState,required:""},model:{value:t.form.nombre,callback:function(e){t.$set(t.form,"nombre",e)},expression:"form.nombre"}},[t._v(t._s(t.form.nombre))])],1),t._v(" "),r("b-form-group",{attrs:{label:"categoria",id:"categoria","label-for":"categoria"}},[r("b-form-select",{attrs:{options:t.categoria},model:{value:t.form.categoria,callback:function(e){t.$set(t.form,"categoria",e)},expression:"form.categoria"}})],1),t._v(" "),r("b-form-group",{attrs:{state:t.nameState,label:"Precio","label-for":"precio","invalid-feedback":"Ingresa un precio"}},[r("b-form-input",{attrs:{type:"number",id:"precio",state:t.nameState,required:""},model:{value:t.form.precio,callback:function(e){t.$set(t.form,"precio",e)},expression:"form.precio"}})],1),t._v(" "),r("b-form-group",{attrs:{state:t.nameState,label:"Cantidad","label-for":"cantidad","invalid-feedback":"Ingresa una cantidad"}},[r("b-form-input",{attrs:{type:"number",id:"cantidad",state:t.nameState,required:""},model:{value:t.form.cantidad,callback:function(e){t.$set(t.form,"cantidad",e)},expression:"form.cantidad"}})],1)],1),t._v(" "),r("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[r("b-button",{attrs:{variant:"primary"},on:{click:t.handleOk}},[t._v("Guardar")]),t._v(" "),r("b-button",{attrs:{variant:"danger"},on:{click:function(e){t.show=!1}}},[t._v("Cancelar")])],1)]),t._v(" "),r("div",{staticClass:"mt-3"},[r("b-pagination",{attrs:{align:"center","total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-sm-11"},[e("h2",[this._v("Listado de productos")])])}],!1,null,null,null);e.default=component.exports}}]);